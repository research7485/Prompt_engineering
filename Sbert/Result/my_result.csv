Cwe,Folder,Palm_Description,Id_of_description_1,Description_from_cwe_website_1,Score_1,Id_of_description_2,Description_from_cwe_website_2,Score_2,Id_of_description_3,Description_from_cwe_website_3,Score_3,Id_of_description_4,Description_from_cwe_website_4,Score_4,Id_of_description_5,Description_from_cwe_website_5,Score_5,Ground_Ranking,Ground_Score,Ground_ID,Ground_Desc
cwe-200,mitre-eg-2,"The `login()` function logs in the user if the username and password are correct. It does this by connecting to a MySQL database, querying the `users` table for the username and password, and returning the user's data if it is found. If the username or password is incorrect, the function returns an error message.",836,"The product records password hashes in a data store, receives a hash of a password from a client, and compares the supplied hash to the hash obtained from the data store.",0.3909,260,The product stores a password in a configuration file that might be accessible to actors who do not know the password.,0.3668,523,Login pages do not use adequate measures to protect the user name and password while they are in transit from the client to the server.,0.3380,393,"A function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result.",0.3363,620,"When setting a new password for a user, the product does not require knowledge of the original password, or using another form of authentication.",0.3304,136,0.0889,200,The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.
cwe-200,mitre-eg-6,"The function `info()` displays sensitive information about the user, including their username, email, and the last four digits of their Social Security number. It does this by first retrieving the user's username, email, and Social Security number from the session. It then extracts the last four digits of the Social Security number and uses them to create a new string. Finally, it returns the new string to the user.",836,"The product records password hashes in a data store, receives a hash of a password from a client, and compares the supplied hash to the hash obtained from the data store.",0.3552,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.3403,213,"The product's intended functionality exposes information to certain actors in accordance with the developer's security policy, but this information is regarded as sensitive according to the intended security policies of other stakeholders such as the product's administrator, users, or others whose information is being processed.",0.3347,1108,"The code is structured in a way that relies too much on using or setting global variables throughout various points in the code, instead of preserving the associated information in a narrower, more local context.",0.3320,798,"The product contains hard-coded credentials, such as a password or cryptographic key, which it uses for its own inbound authentication, outbound communication to external components, or encryption of internal data.",0.3121,62,0.2221,200,The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.
cwe-200,mitre-eg-1,"The `login()` function logs in the user if the username and password are correct. It does this by first connecting to a MySQL database and then executing a query to select the user's data from the `users` table. If the user's data is found, the function redirects the user to the `/home` page. Otherwise, the function returns a message stating that the username or password is incorrect.",523,Login pages do not use adequate measures to protect the user name and password while they are in transit from the client to the server.,0.3651,601,"A web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect. This simplifies phishing attacks.",0.3300,836,"The product records password hashes in a data store, receives a hash of a password from a client, and compares the supplied hash to the hash obtained from the data store.",0.3221,260,The product stores a password in a configuration file that might be accessible to actors who do not know the password.,0.3143,639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.2771,139,0.0656,200,The product exposes sensitive information to an actor that is not explicitly authorized to have access to that information.
cwe-434,my-eg-1,"The function `upload_pdf()` saves the uploaded pdf file to the `./uploads` directory. It does this by first getting the file object from the `request.files` dictionary, and then saving it to the specified directory. The function returns a message indicating that the file was uploaded successfully.",379,The product creates a temporary file in a directory whose permissions allow unintended actors to determine the file's existence or otherwise access that file.,0.3095,494,The product downloads source code or an executable from a remote location and executes the code without sufficiently verifying the origin and integrity of the code.,0.2681,910,The product uses or accesses a file descriptor after it has been closed.,0.2661,434,The product allows the attacker to upload or transfer files of dangerous types that can be automatically processed within the product's environment.,0.2492,1084,A function or method contains too many operations that utilize a data manager or file resource.,0.2474,4,0.2492,434,The product allows the attacker to upload or transfer files of dangerous types that can be automatically processed within the product's environment.
cwe-434,my-eg-3,"The `upload_file()` function saves uploaded files to the folder `./uploads` if they are safe and if they are less than 2MB. The function first checks the file size and returns an error message if the file is too large. The function then checks the file type and returns an error message if the file is not a safe type. If the file is safe and is not too large, the function saves the file to the `./uploads` folder and returns a success message.",1084,A function or method contains too many operations that utilize a data manager or file resource.,0.3941,434,The product allows the attacker to upload or transfer files of dangerous types that can be automatically processed within the product's environment.,0.3691,379,The product creates a temporary file in a directory whose permissions allow unintended actors to determine the file's existence or otherwise access that file.,0.3554,378,"Opening temporary files without appropriate measures or controls can leave the file, its contents and any function that it impacts vulnerable to attack.",0.3425,910,The product uses or accesses a file descriptor after it has been closed.,0.3132,2,0.3691,434,The product allows the attacker to upload or transfer files of dangerous types that can be automatically processed within the product's environment.
cwe-787,mitre-eg-2,"The function `main` is the entry point of the program. It is responsible for initializing the program, processing user input, and displaying output. In this case, the function allocates two chunks of memory, sets their sizes, and then copies the contents of the first chunk to the second chunk.",466,A function can return a pointer to memory that is outside of the buffer that the pointer is expected to reference.,0.5346,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.4867,786,The product reads or writes to a buffer using an index or pointer that references a memory location prior to the beginning of the buffer.,0.4787,1109,"The code contains a callable, block, or other code element in which the same variable is used to control more than one unique task or store more than one instance of data.",0.4754,788,The product reads or writes to a buffer using an index or pointer that references a memory location after the end of the buffer.,0.4739,18,0.3762,787,"The product writes data past the end, or before the beginning, of the intended buffer."
cwe-787,codeql-eg-PotentialBufferOverflow,"The `main()` function is the entry point of the program. It is responsible for initializing the program, processing user input, and displaying output. In this case, the `main()` function generates three random floats, converts them to strings, and prints them to the console.",1102,"The code uses a data representation that relies on low-level data representation or constructs that may vary across different processors, physical machines, OSes, or other physical components.",0.4870,1109,"The code contains a callable, block, or other code element in which the same variable is used to control more than one unique task or store more than one instance of data.",0.4472,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.4330,1108,"The code is structured in a way that relies too much on using or setting global variables throughout various points in the code, instead of preserving the associated information in a narrower, more local context.",0.4028,786,The product reads or writes to a buffer using an index or pointer that references a memory location prior to the beginning of the buffer.,0.3945,20,0.3328,787,"The product writes data past the end, or before the beginning, of the intended buffer."
cwe-125,my-1,"The `main()` function is the entry point of a C program. It is where the program starts executing. The `main()` function takes two arguments: `argc` and `argv`. `argc` is the number of command-line arguments, and `argv` is an array of pointers to the command-line arguments.

The `main()` function typically does the following:

* Declares and initializes variables.
* Reads input from the user.
* Performs calculations.
* Writes output to the screen.
* Returns a value to the operating system.

In the code you provided, the `main()` function declares an array of integers called `id_sequence`. The array has three elements, which are initialized to the values 1, 5, and 7. The function then prompts the user for an index value and stores it in the variable `i`. The function then checks to see if `i` is in the range of 0 to 2, which is the size of the `id_sequence` array. If `i` is in range, the function returns the value at the specified index in the array. Otherwise, the function returns 0.",562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.4803,466,A function can return a pointer to memory that is outside of the buffer that the pointer is expected to reference.,0.4492,1102,"The code uses a data representation that relies on low-level data representation or constructs that may vary across different processors, physical machines, OSes, or other physical components.",0.4311,1108,"The code is structured in a way that relies too much on using or setting global variables throughout various points in the code, instead of preserving the associated information in a narrower, more local context.",0.4103,1109,"The code contains a callable, block, or other code element in which the same variable is used to control more than one unique task or store more than one instance of data.",0.4080,28,0.3182,125,"The product reads data past the end, or before the beginning, of the intended buffer."
cwe-190,mitre-eg-4,"The function main is the entry point of the program. It is responsible for initializing the program, calling the functions that perform the desired tasks, and cleaning up after the program has finished running. In this case, the function main calls the function getMonthlySales to get the number of sales for each month in the first quarter, and then adds them together to get the total sales for the first quarter.",1041,"The product has multiple functions, methods, procedures, macros, etc. that contain the same code.",0.4284,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.4282,628,"The product calls a function, procedure, or routine with arguments that are not correctly specified, leading to always-incorrect behavior and resultant weaknesses.",0.4153,1084,A function or method contains too many operations that utilize a data manager or file resource.,0.4061,1109,"The code contains a callable, block, or other code element in which the same variable is used to control more than one unique task or store more than one instance of data.",0.4028,40,0.2620,190,"The product performs a calculation that can produce an integer overflow or wraparound, when the logic assumes that the resulting value will always be larger than the original value. This can introduce other weaknesses when the calculation is used for resource management or execution control."
cwe-190,codeql-eg-ArithmeticTainted,"The function main is the entry point of the program. It is responsible for reading in the value from the command line, calculating the correct value with the offset of 1000 added, and printing the result to the console.",562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.4618,1109,"The code contains a callable, block, or other code element in which the same variable is used to control more than one unique task or store more than one instance of data.",0.4391,466,A function can return a pointer to memory that is outside of the buffer that the pointer is expected to reference.,0.4202,1108,"The code is structured in a way that relies too much on using or setting global variables throughout various points in the code, instead of preserving the associated information in a narrower, more local context.",0.4129,1102,"The code uses a data representation that relies on low-level data representation or constructs that may vary across different processors, physical machines, OSes, or other physical components.",0.4032,32,0.2947,190,"The product performs a calculation that can produce an integer overflow or wraparound, when the logic assumes that the resulting value will always be larger than the original value. This can introduce other weaknesses when the calculation is used for resource management or execution control."
cwe-22,codeql-eg-Python-TaintedPath,"The `img()` function is a Flask route that returns an image from the `images` folder. The function first checks if the `file_name` parameter contains the `../` pattern. If it does, the function returns the string ""Bad Image name"". Otherwise, the function checks if the `file_path` exists. If it does, the function redirects the user to the file path. Otherwise, the function returns the string ""Image not found!"".",59,"The product attempts to access a file based on the filename, but it does not properly prevent that filename from identifying a link or shortcut that resolves to an unintended resource.",0.3110,248,"An exception is thrown from a function, but it is not caught.",0.2982,379,The product creates a temporary file in a directory whose permissions allow unintended actors to determine the file's existence or otherwise access that file.,0.2937,66,"The product does not handle or incorrectly handles a file name that identifies a virtual resource that is not directly specified within the directory that is associated with the file name, causing the product to perform file-based operations on a resource that is not a file.",0.2844,134,"The product uses a function that accepts a format string as an argument, but the format string originates from an external source.",0.2700,10,0.2543,22,"The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory."
cwe-22,codeql-eg-C-TaintedPath,"The `main()` function is the entry point of the program. It is responsible for initializing the program, reading the requested file from the safe directory, and printing the file data.

The `main()` function first checks if the requested file name contains the sequence `..`. If it does, the function prints an error message and exits. Otherwise, the function concatenates the restricted safe directory and the requested file name to create a new file name. The function then opens the file and reads its data. Finally, the function prints the data to the console.",1109,"The code contains a callable, block, or other code element in which the same variable is used to control more than one unique task or store more than one instance of data.",0.4764,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.4648,1084,A function or method contains too many operations that utilize a data manager or file resource.,0.4617,1058,The code contains a function or method that operates in a multi-threaded environment but owns an unsafe non-final static storable or member data element.,0.4611,910,The product uses or accesses a file descriptor after it has been closed.,0.4491,63,0.2808,22,"The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory."
cwe-78,codeql-eg-c-ExecTainted,"The `main` function is the entry point of the program. It is responsible for initializing the program and then calling the appropriate functions to perform the desired tasks. In this case, the `main` function gets the username from the command line and then uses the `system` function to run the `ls - l` command on the user's home directory.",1109,"The code contains a callable, block, or other code element in which the same variable is used to control more than one unique task or store more than one instance of data.",0.3790,214,"A process is invoked with sensitive command-line arguments, environment variables, or other elements that can be seen by other processes on the operating system.",0.3751,1107,"The source code uses symbolic constants, but it does not sufficiently place the definitions of these constants into a more centralized or isolated location.",0.3430,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.3428,1108,"The code is structured in a way that relies too much on using or setting global variables throughout various points in the code, instead of preserving the associated information in a narrower, more local context.",0.3226,152,0.1075,78,"The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component."
cwe-78,my-1,"The `main()` function is the entry point of the program. It is responsible for initializing the program, reading the command line arguments, and calling the appropriate functions to perform the desired tasks. In this case, the `main()` function reads the directory name from the command line and uses the `ls` command line utility to list the contents of that directory.",1109,"The code contains a callable, block, or other code element in which the same variable is used to control more than one unique task or store more than one instance of data.",0.3954,214,"A process is invoked with sensitive command-line arguments, environment variables, or other elements that can be seen by other processes on the operating system.",0.3862,1062,"The code has a parent class that contains references to a child class, its methods, or its members.",0.3859,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.3753,1107,"The source code uses symbolic constants, but it does not sufficiently place the definitions of these constants into a more centralized or isolated location.",0.3643,133,0.1230,78,"The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component."
cwe-78,codeql-eg-python-CommandInjection,"The `ping` function pings a URL to see if it is alive using the ""ping"" system command. It first checks if the URL contains a semicolon, in which case it returns ""Bad Url provided"". If the URL does not contain a semicolon, it runs the ping command using the system command ""ping"". The command is ""ping -c 5 "" + url, where ""-c 5"" means to send 5 pings to the URL. The result of the ping command is captured and returned as a string.",562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.3746,601,"A web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect. This simplifies phishing attacks.",0.3011,253,"The product incorrectly checks a return value from a function, which prevents it from detecting errors or exceptional conditions.",0.2946,353,"The product uses a transmission protocol that does not include a mechanism for verifying the integrity of the data during transmission, such as a checksum.",0.2922,698,"The web application sends a redirect to another location, but instead of exiting, it executes additional code.",0.2918,248,0.0806,78,"The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component."
cwe-79,codeql-eq-ReflectedXss,"The `hello` function takes a username as a parameter and returns a string that says ""Hello, [username]"". The username is first escaped to prevent it from being interpreted as HTML code.",1117,"The code contains a function or method whose signature and/or associated inline documentation does not sufficiently describe the callable's inputs, outputs, side effects, assumptions, or return codes.",0.4002,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.3342,79,The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.,0.3207,1108,"The code is structured in a way that relies too much on using or setting global variables throughout various points in the code, instead of preserving the associated information in a narrower, more local context.",0.3050,624,"The product uses a regular expression that either (1) contains an executable component with user-controlled inputs, or (2) allows a user to enable execution by inserting pattern modifiers.",0.2945,3,0.3207,79,The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.
cwe-79,codeql-eg-ExternalAPISinkExample,"The function `http_hello_page` takes a URL, a method, a request file, and a response file as input. It then reads the username from the request file, constructs a response saying ""hello, [username]"" with the PAGE defines, and writes the response to the response file.",1117,"The code contains a function or method whose signature and/or associated inline documentation does not sufficiently describe the callable's inputs, outputs, side effects, assumptions, or return codes.",0.4307,601,"A web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect. This simplifies phishing attacks.",0.3538,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.3378,1102,"The code uses a data representation that relies on low-level data representation or constructs that may vary across different processors, physical machines, OSes, or other physical components.",0.3122,918,"The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination.",0.3097,44,0.2201,79,The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.
cwe-416,mitre-eg-2,"The function main is the entry point of the program. It is responsible for initializing the program, reading input from the user, and performing the desired operations. In this case, the function main reads a line of input from the user and stores it in an array. The function then prints the contents of the array to the screen.",562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.4669,466,A function can return a pointer to memory that is outside of the buffer that the pointer is expected to reference.,0.4623,1109,"The code contains a callable, block, or other code element in which the same variable is used to control more than one unique task or store more than one instance of data.",0.4391,786,The product reads or writes to a buffer using an index or pointer that references a memory location prior to the beginning of the buffer.,0.4226,788,The product reads or writes to a buffer using an index or pointer that references a memory location after the end of the buffer.,0.4107,111,0.1848,416,"Referencing memory after it has been freed can cause a program to crash, use unexpected values, or execute code."
cwe-416,my-eg-1,"The function `main()` is the entry point of the program. It is responsible for opening the file, reading the file into a buffer, calculating the checksum of the buffer, and saving the number of bytes read to the buffer and the checksum to the results file.",786,The product reads or writes to a buffer using an index or pointer that references a memory location prior to the beginning of the buffer.,0.4839,788,The product reads or writes to a buffer using an index or pointer that references a memory location after the end of the buffer.,0.4767,466,A function can return a pointer to memory that is outside of the buffer that the pointer is expected to reference.,0.4677,125,"The product reads data past the end, or before the beginning, of the intended buffer.",0.4542,1109,"The code contains a callable, block, or other code element in which the same variable is used to control more than one unique task or store more than one instance of data.",0.4435,60,0.2549,416,"Referencing memory after it has been freed can cause a program to crash, use unexpected values, or execute code."
cwe-119,mitre-eg-3,"The function main() is the entry point of the program. It is where the program starts executing. The function takes two arguments: argc and argv. argc is the number of command-line arguments, and argv is an array of pointers to the command-line arguments.

The function main() typically does the following:

* Declares and initializes variables.
* Reads input from the user.
* Performs calculations.
* Writes output to the screen.
* Returns a value to the operating system.

In the code you provided, the function main() does the following:

* Declares an array of strings called vehicles.
* Prompts the user for the index of a vehicle.
* Reads the index from the user.
* Checks if the index is valid.
* If the index is valid, prints the corresponding vehicle name.
* Otherwise, prints an error message.",562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.4789,1109,"The code contains a callable, block, or other code element in which the same variable is used to control more than one unique task or store more than one instance of data.",0.4450,628,"The product calls a function, procedure, or routine with arguments that are not correctly specified, leading to always-incorrect behavior and resultant weaknesses.",0.4185,466,A function can return a pointer to memory that is outside of the buffer that the pointer is expected to reference.,0.4129,1062,"The code has a parent class that contains references to a child class, its methods, or its members.",0.4079,31,0.3104,119,"The product performs operations on a memory buffer, but it can read from or write to a memory location that is outside of the intended boundary of the buffer."
cwe-119,codeql-eg-OverflowBuffer,"The function main is the entry point of the program. It is responsible for initializing the program, processing the user input, and displaying the output. In this case, the function main initializes the variable message to the string ""Hello"" and the variable buffer to an array of 256 characters. It then checks if the buffer is large enough to hold the message, and if so, it copies the message to the buffer. Finally, the function main prints the message to the screen.",466,A function can return a pointer to memory that is outside of the buffer that the pointer is expected to reference.,0.4827,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.4806,786,The product reads or writes to a buffer using an index or pointer that references a memory location prior to the beginning of the buffer.,0.4671,788,The product reads or writes to a buffer using an index or pointer that references a memory location after the end of the buffer.,0.4589,125,"The product reads data past the end, or before the beginning, of the intended buffer.",0.4582,11,0.4037,119,"The product performs operations on a memory buffer, but it can read from or write to a memory location that is outside of the intended boundary of the buffer."
cwe-798,codeql-eg-HardcodedCredentials-c,"The function `get_db_connection()` connects to a MySQL database and returns a connection object. The function takes four parameters: the host name of the database server, the username, the password, and the name of the database. The function uses the MySQLdb library to connect to the database. The connection object can then be used to execute SQL queries and retrieve data from the database.",1072,The product accesses a data resource through a database without using a connection pooling capability.,0.3935,1073,"The product contains a client with a function or method that contains a large number of data accesses/queries that are sent through a data manager, i.e., does not use efficient database capabilities.",0.3787,1083,"The product is intended to manage data access through a particular data manager component such as a relational or non-SQL database, but it contains code that performs data access operations without using that component.",0.3320,798,"The product contains hard-coded credentials, such as a password or cryptographic key, which it uses for its own inbound authentication, outbound communication to external components, or encryption of internal data.",0.3012,1327,"The product assigns the address 0.0.0.0 for a database server, a cloud service/instance, or any computing resource that communicates remotely.",0.2814,4,0.3012,798,"The product contains hard-coded credentials, such as a password or cryptographic key, which it uses for its own inbound authentication, outbound communication to external components, or encryption of internal data."
cwe-798,codeql-eg-HardcodedCredentials-a,"The function `check_mod()` checks if the user is a moderator. It does this by checking if the username and password match the values 'mod' and 'modpass', respectively. If they do, the function returns True, otherwise it returns False.",394,"The product does not properly check when a function or operation returns a value that is legitimate for the function, but is not expected by the product.",0.2945,289,"The product performs authentication based on the name of a resource being accessed, or the name of the actor performing the access, but it does not properly check all possible names for that resource or actor.",0.2862,260,The product stores a password in a configuration file that might be accessible to actors who do not know the password.,0.2838,393,"A function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result.",0.2770,273,The product attempts to drop privileges but does not check or incorrectly checks to see if the drop succeeded.,0.2768,37,0.1895,798,"The product contains hard-coded credentials, such as a password or cryptographic key, which it uses for its own inbound authentication, outbound communication to external components, or encryption of internal data."
cwe-89,my-eg-1,"The `buy_stock()` function takes in the stock name, stock quantity, and username from the user and inserts a buy order into the database. The function first connects to the database using the MySQLdb library. Then, it creates a cursor and executes an SQL statement to insert the buy order into the database. Finally, the function commits the changes to the database and closes the cursor and connection.",1083,"The product is intended to manage data access through a particular data manager component such as a relational or non-SQL database, but it contains code that performs data access operations without using that component.",0.4151,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.3668,1067,The product contains a data query against an SQL table or view that is configured in a way that does not utilize an index and may cause sequential searches to be performed.,0.3619,1073,"The product contains a client with a function or method that contains a large number of data accesses/queries that are sent through a data manager, i.e., does not use efficient database capabilities.",0.3536,1072,The product accesses a data resource through a database without using a connection pooling capability.,0.3454,15,0.3150,89,"The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component."
cwe-20,my-eg-1,"The function `calculate_sale_value()` calculates the value of a sale of a number of shares where the price comes from `get_market_price()`. It takes two inputs: the symbol of the stock and the number of shares. It returns the value of the sale, which is always positive or 0. If an error occurs, it returns 0.

The function first calls `get_market_price()` to get the market price of the stock. If `get_market_price()` returns -1, then an error has occurred and the function returns 0. Otherwise, the function multiplies the market price by the number of shares to get the value of the sale. The function then returns the value of the sale.",393,"A function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result.",0.5053,193,"A product calculates or uses an incorrect maximum or minimum value that is 1 more, or 1 less, than the correct value.",0.4705,394,"The product does not properly check when a function or operation returns a value that is legitimate for the function, but is not expected by the product.",0.4547,628,"The product calls a function, procedure, or routine with arguments that are not correctly specified, leading to always-incorrect behavior and resultant weaknesses.",0.4259,563,"The variable's value is assigned but never used, making it a dead store.",0.4204,68,0.2178,20,"The product receives input or data, but it does not validate or incorrectly validates that the input has the properties that are required to process the data safely and correctly."
cwe-476,codeql-eg-MissingNullTest-b,"The function main is the entry point of the program. It is responsible for initializing the program, calling the functions that perform the desired tasks, and cleaning up after the program has finished running.

In the code you provided, the function main allocates a new person structure, sets the status to 0, and then frees the structure.",562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.4391,1082,The code contains a class instance that calls the method or function to delete or destroy itself.,0.4387,1109,"The code contains a callable, block, or other code element in which the same variable is used to control more than one unique task or store more than one instance of data.",0.4337,466,A function can return a pointer to memory that is outside of the buffer that the pointer is expected to reference.,0.4319,1058,The code contains a function or method that operates in a multi-threaded environment but owns an unsafe non-final static storable or member data element.,0.4307,50,0.2509,476,"A NULL pointer dereference occurs when the application dereferences a pointer that it expects to be valid, but is NULL, typically causing a crash or exit."
cwe-476,codeql-eg-MissingNullTest-a,"The function main is the entry point of the program. It is responsible for initializing the program, processing user input, and displaying output. In this case, the function allocates a new person and sets its status to 0. It then frees the person when it is no longer needed.",562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.4715,466,A function can return a pointer to memory that is outside of the buffer that the pointer is expected to reference.,0.4669,1109,"The code contains a callable, block, or other code element in which the same variable is used to control more than one unique task or store more than one instance of data.",0.4571,1082,The code contains a class instance that calls the method or function to delete or destroy itself.,0.4306,1084,A function or method contains too many operations that utilize a data manager or file resource.,0.4100,86,0.2482,476,"A NULL pointer dereference occurs when the application dereferences a pointer that it expects to be valid, but is NULL, typically causing a crash or exit."
cwe-434,my-eg-2,"The upload_image() function in a Flask application handles image uploads. It checks if the uploaded file is a JPG image and if its size is less than 1024KB. If valid, the function base64 encodes the image and saves it along with its name to a MySQL database table named images. The function returns a success message if the upload is successful, or appropriate error messages for invalid images or large file sizes.",1084,A function or method contains too many operations that utilize a data manager or file resource.,0.2466,434,The product allows the attacker to upload or transfer files of dangerous types that can be automatically processed within the product's environment.,0.2442,248,"An exception is thrown from a function, but it is not caught.",0.2253,338,"The product uses a Pseudo-Random Number Generator (PRNG) in a security context, but the PRNG's algorithm is not cryptographically strong.",0.2248,1285,"The product receives input that is expected to specify an index, position, or offset into an indexable resource such as a buffer or file, but it does not validate or incorrectly validates that the specified index/position/offset has the required properties.",0.2234,2,0.2442,434,The product allows the attacker to upload or transfer files of dangerous types that can be automatically processed within the product's environment.
cwe-125,my-2,"The getidfromarray function takes an integer index as input and returns the value at that index from the global integer array ids. The function first checks if the index is within the valid bounds of the array (0 to IDS_ARRAY_SIZE - 1). If the index is out of bounds (less than 0 or greater than or equal to IDS_ARRAY_SIZE), the function returns -1 to indicate an error. Otherwise, it returns the value stored in the ids array at the specified index.",562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.3950,253,"The product incorrectly checks a return value from a function, which prevents it from detecting errors or exceptional conditions.",0.3669,393,"A function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result.",0.3494,1025,"The code performs a comparison between two entities, but the comparison examines the wrong factors or characteristics of the entities, which can lead to incorrect results and resultant weaknesses.",0.3474,1335,An integer value is specified to be shifted by a negative amount or an amount greater than or equal to the number of bits contained in the value causing an unexpected or indeterminate result.,0.3421,36,0.2278,125,"The product reads data past the end, or before the beginning, of the intended buffer."
cwe-125,mitre-eg-1,"The getValueFromArray function takes an array of integers, the size of the array, and an index as input. It returns the value at the given index if the index is within bounds, and -1 if the index is out of bounds.",1335,An integer value is specified to be shifted by a negative amount or an amount greater than or equal to the number of bits contained in the value causing an unexpected or indeterminate result.,0.4639,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.3810,466,A function can return a pointer to memory that is outside of the buffer that the pointer is expected to reference.,0.3637,191,"The product subtracts one value from another, such that the result is less than the minimum allowable integer value, which produces a value that is not equal to the correct result.",0.3509,393,"A function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result.",0.3479,26,0.2256,125,"The product reads data past the end, or before the beginning, of the intended buffer."
cwe-190,codeql-eg-ArithmeticUncontrolled,"The main function in this program generates a random integer larger than 1000. It does this by first initializing the random number generator with the seed 0. It then generates a random integer between 1001 and INT_MAX (the maximum value of an integer). Finally, it prints the random integer to standard output.",343,"The product's random number generator produces a series of values which, when observed, can be used to infer a relatively small range of possibilities for the next value that could be generated.",0.6059,1241,The device uses an algorithm that is predictable and generates a pseudo-random number.,0.5116,335,The product uses a Pseudo-Random Number Generator (PRNG) but does not correctly manage seeds.,0.4503,334,"The number of possible random values is smaller than needed by the product, making it more susceptible to brute force attacks.",0.4402,338,"The product uses a Pseudo-Random Number Generator (PRNG) in a security context, but the PRNG's algorithm is not cryptographically strong.",0.4198,9,0.3678,190,"The product performs a calculation that can produce an integer overflow or wraparound, when the logic assumes that the resulting value will always be larger than the original value. This can introduce other weaknesses when the calculation is used for resource management or execution control."
cwe-22,codeql-eg-TarSlip,The program unzips the tar file to /tmp/unpack.,378,"Opening temporary files without appropriate measures or controls can leave the file, its contents and any function that it impacts vulnerable to attack.",0.3246,494,The product downloads source code or an executable from a remote location and executes the code without sufficiently verifying the origin and integrity of the code.,0.3145,459,The product does not properly clean up and remove temporary or supporting resources after they have been used.,0.3143,379,The product creates a temporary file in a directory whose permissions allow unintended actors to determine the file's existence or otherwise access that file.,0.3125,276,"During installation, installed file permissions are set to allow anyone to modify those files.",0.3118,89,0.1316,22,"The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory."
cwe-416,codeql-UseAfterFree,"The main function in C is responsible for initializing the program and calling the functions that perform the program's tasks. In this case, the main function first gets the buffer size from the command-line arguments, then allocates a buffer of that size. The main function then does something with the buffer, such as reading data from it or writing data to it. Finally, the main function frees the memory that was allocated for the buffer.",466,A function can return a pointer to memory that is outside of the buffer that the pointer is expected to reference.,0.5734,786,The product reads or writes to a buffer using an index or pointer that references a memory location prior to the beginning of the buffer.,0.4821,124,The product writes to a buffer using an index or pointer that references a memory location prior to the beginning of the buffer.,0.4781,788,The product reads or writes to a buffer using an index or pointer that references a memory location after the end of the buffer.,0.4776,805,"The product uses a sequential operation to read or write a buffer, but it uses an incorrect length value that causes it to access memory that is outside of the bounds of the buffer.",0.4613,7,0.4478,416,"Referencing memory after it has been freed can cause a program to crash, use unexpected values, or execute code."
cwe-119,my-eg-1,The function returns the argument from argv[] that corresponds to the index in argv[1].,466,A function can return a pointer to memory that is outside of the buffer that the pointer is expected to reference.,0.3775,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.3582,134,"The product uses a function that accepts a format string as an argument, but the format string originates from an external source.",0.3179,1126,"The source code declares a variable in one scope, but the variable is only used within a narrower scope.",0.2786,822,"The product obtains a value from an untrusted source, converts this value to a pointer, and dereferences the resulting pointer.",0.2699,89,0.1380,119,"The product performs operations on a memory buffer, but it can read from or write to a memory location that is outside of the intended boundary of the buffer."
cwe-798,codeql-eg-HardcodedCredentials-b,"The checkmod function checks if a user is a moderator. It does this by querying the database for the username and password provided. If the user is found in the database and their password matches, the function returns true. Otherwise, it returns false.",394,"The product does not properly check when a function or operation returns a value that is legitimate for the function, but is not expected by the product.",0.3111,289,"The product performs authentication based on the name of a resource being accessed, or the name of the actor performing the access, but it does not properly check all possible names for that resource or actor.",0.3009,839,"The product checks a value to ensure that it is less than or equal to a maximum, but it does not also verify that the value is greater than or equal to the minimum.",0.2964,252,"The product does not check the return value from a method or function, which can prevent it from detecting unexpected states and conditions.",0.2825,649,"The product uses obfuscation or encryption of inputs that should not be mutable by an external actor, but the product does not use integrity checks to detect if those inputs have been modified.",0.2751,62,0.1712,798,"The product contains hard-coded credentials, such as a password or cryptographic key, which it uses for its own inbound authentication, outbound communication to external components, or encryption of internal data."
cwe-306,my-eg-1,The settings function is a route that is only accessible to users who are logged in. It displays a page with secret settings.,15,One or more system settings or configuration elements can be externally controlled by a user.,0.4718,565,"The product relies on the existence or values of cookies when performing security-critical operations, but it does not properly ensure that the setting is valid for the associated user.",0.3978,447,"A UI function for a security feature appears to be supported and gives feedback to the user that suggests that it is supported, but the underlying functionality is not implemented.",0.3882,1220,"The product implements access controls via a policy or other feature with the intention to disable or restrict accesses (reads and/or writes) to assets in a system from untrusted agents. However, implemented access controls lack required granularity, which renders the control policy too broad because it allows accesses from unauthorized agents to the security-sensitive assets.",0.3764,618,"An ActiveX control is intended for use in a web browser, but it exposes dangerous methods that perform actions that are outside of the browser's security model (e.g. the zone or domain).",0.3329,169,0.1311,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.
cwe-306,my-eg-2,"The admin_page function checks if the user is logged in and if they are an admin. If they are, it returns a secret page. Otherwise, it returns a permission denied message.",756,"The product does not return custom error pages to the user, possibly exposing sensitive information.",0.3945,639,The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.,0.3384,425,"The web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files.",0.3122,267,"A particular privilege, role, capability, or right can be used to perform unsafe actions that were not intended, even when it is assigned to the correct entity.",0.3010,523,Login pages do not use adequate measures to protect the user name and password while they are in transit from the client to the server.,0.2985,37,0.2169,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.
cwe-306,my-eg-3,"The change_email function is a POST function that allows a user to change their email address. The function first checks to make sure that the user is logged in and has provided the current password. If the user is not logged in or has not provided the correct password, the function returns an error message.

If the user is logged in and has provided the correct password, the function checks to make sure that the new email address is different from the old email address. If the new email address is the same as the old email address, the function returns an error message.

If the new email address is different from the old email address, the function checks to make sure that the new email address is not already in use. If the new email address is already in use, the function returns an error message.

If the new email address is not already in use, the function updates the user's email address in the database and returns a success message.",393,"A function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result.",0.3426,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.3133,620,"When setting a new password for a user, the product does not require knowledge of the original password, or using another form of authentication.",0.3105,836,"The product records password hashes in a data store, receives a hash of a password from a client, and compares the supplied hash to the hash obtained from the data store.",0.2813,640,"The product contains a mechanism for users to recover or change their passwords without knowing the original password, but the mechanism is weak.",0.2811,199,0.0680,306,The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.
cwe-787,mitre-eg-5,"The main function does the following:

1. Checks if the user provided 1 argument.
2. Gets the argument.
3. Prints the argument.
4. Trims the trailing whitespace from the argument.
5. Prints the argument again.",474,The code uses a function that has inconsistent implementations across operating systems and versions.,0.4011,466,A function can return a pointer to memory that is outside of the buffer that the pointer is expected to reference.,0.3712,1117,"The code contains a function or method whose signature and/or associated inline documentation does not sufficiently describe the callable's inputs, outputs, side effects, assumptions, or return codes.",0.3572,478,"The code does not have a default case in an expression with multiple conditions, such as a switch statement.",0.3448,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.3353,24,0.2706,787,"The product writes data past the end, or before the beginning, of the intended buffer."
cwe-732,codeql-eg-DoNotCreateWorldWriteable-a,"The main function saves the important config to a file and changes the permissions of the config file to read and write for the owner, and read-only for everyone else.",15,One or more system settings or configuration elements can be externally controlled by a user.,0.4760,276,"During installation, installed file permissions are set to allow anyone to modify those files.",0.3797,921,The product stores sensitive information in a file system or device that does not have built-in access control.,0.3587,732,The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.,0.3537,73,The product allows user input to control or influence paths or file names that are used in filesystem operations.,0.3495,4,0.3537,732,The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.
cwe-732,codeql-eg-DoNotCreateWorldWriteable-b,"The main function saves the important config to a file, ensuring it is not world-writable. It then changes the permissions of the config file to read for everyone.",15,One or more system settings or configuration elements can be externally controlled by a user.,0.4373,1108,"The code is structured in a way that relies too much on using or setting global variables throughout various points in the code, instead of preserving the associated information in a narrower, more local context.",0.4076,276,"During installation, installed file permissions are set to allow anyone to modify those files.",0.3849,1107,"The source code uses symbolic constants, but it does not sufficiently place the definitions of these constants into a more centralized or isolated location.",0.3449,732,The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.,0.3219,5,0.3219,732,The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.
cwe-732,codeql-eg-WeakFilePermissions,The program saves the super secret info to a file called secret.txt and sets restricted permissions on the file so that only the owner can read it.,921,The product stores sensitive information in a file system or device that does not have built-in access control.,0.5326,379,The product creates a temporary file in a directory whose permissions allow unintended actors to determine the file's existence or otherwise access that file.,0.4953,910,The product uses or accesses a file descriptor after it has been closed.,0.4472,1220,"The product implements access controls via a policy or other feature with the intention to disable or restrict accesses (reads and/or writes) to assets in a system from untrusted agents. However, implemented access controls lack required granularity, which renders the control policy too broad because it allows accesses from unauthorized agents to the security-sensitive assets.",0.4450,732,The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.,0.4322,5,0.4322,732,The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.
cwe-89,my-eg-2,"
 The insert_user_message_in_db function inserts a user's message into the database. It takes two parameters: the username of the user and the message they want to post. The function first gets a connection to the database using the get_db_connection function. It then creates a cursor and executes an INSERT INTO statement to insert the user's message into the database. The function finally commits the changes to the database and closes the connection.",562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.3418,619,"If a database cursor is not closed properly, then it could become accessible to other users while retaining the same privileges that were originally assigned, leaving the cursor dangling.",0.3176,1073,"The product contains a client with a function or method that contains a large number of data accesses/queries that are sent through a data manager, i.e., does not use efficient database capabilities.",0.3099,1083,"The product is intended to manage data access through a particular data manager component such as a relational or non-SQL database, but it contains code that performs data access operations without using that component.",0.2952,1117,"The code contains a function or method whose signature and/or associated inline documentation does not sufficiently describe the callable's inputs, outputs, side effects, assumptions, or return codes.",0.2588,40,0.2087,89,"The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component."
cwe-89,codeql-eg-SqlInjection-a,"The unsubscribe function checks if the email (GET variable) is in the database and if so, unsubscribes the user. It does this by making a query to check if the user is already on the subscribe list. If the user is found, a query is made to remove the row with the given email. The connection is then committed and closed.",375,Sending non-cloned mutable data as a return value may result in that data being altered or deleted by the calling function.,0.3182,924,"The product establishes a communication channel with an endpoint and receives a message from that endpoint, but it does not sufficiently ensure that the message was not modified during transmission.",0.2870,501,The product mixes trusted and untrusted data in the same data structure or structured message.,0.2744,640,"The product contains a mechanism for users to recover or change their passwords without knowing the original password, but the mechanism is weak.",0.2567,260,The product stores a password in a configuration file that might be accessible to actors who do not know the password.,0.2549,116,0.1369,89,"The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component."
cwe-20,codeql-eg-IncompleteHostnameRegExp,"The unsubscribe function checks if the target URL is for the example.com domain. If it is, the function redirects the user to the target URL. If it is not, the function redirects the user to the home page.",601,"A web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect. This simplifies phishing attacks.",0.3871,698,"The web application sends a redirect to another location, but instead of exiting, it executes additional code.",0.3121,1265,"During execution of non-reentrant code, the product performs a call that unintentionally produces a nested invocation of the non-reentrant code.",0.2912,204,The product provides different responses to incoming requests in a way that reveals internal state information to an unauthorized actor outside of the intended control sphere.,0.2710,375,Sending non-cloned mutable data as a return value may result in that data being altered or deleted by the calling function.,0.2707,100,0.1586,20,"The product receives input or data, but it does not validate or incorrectly validates that the input has the properties that are required to process the data safely and correctly."
cwe-20,codeql-eg-IncompleteUrlSubstringSanitization,"The redirect_func function takes a URL as a parameter and redirects the user to that URL if the URL is for the ""example.com"" domain. If the URL is not for the ""example.com"" domain, the function returns a message indicating that the URL is invalid.",601,"A web application accepts a user-controlled input that specifies a link to an external site, and uses that link in a Redirect. This simplifies phishing attacks.",0.4189,698,"The web application sends a redirect to another location, but instead of exiting, it executes additional code.",0.3650,562,"A function returns the address of a stack variable, which will cause unintended program behavior, typically in the form of a crash.",0.3109,248,"An exception is thrown from a function, but it is not caught.",0.2982,393,"A function or operation returns an incorrect return value or status code that does not indicate an error, but causes the product to modify its behavior based on the incorrect result.",0.2932,106,0.1137,20,"The product receives input or data, but it does not validate or incorrectly validates that the input has the properties that are required to process the data safely and correctly."
cwe-476,codeql-eg-MissingNullTest-c,The main function allocates a buffer of size 1024 bytes and copies the first 100 characters from standard input into the buffer.,787,"The product writes data past the end, or before the beginning, of the intended buffer.",0.5418,805,"The product uses a sequential operation to read or write a buffer, but it uses an incorrect length value that causes it to access memory that is outside of the bounds of the buffer.",0.5413,125,"The product reads data past the end, or before the beginning, of the intended buffer.",0.5326,120,"The product copies an input buffer to an output buffer without verifying that the size of the input buffer is less than the size of the output buffer, leading to a buffer overflow.",0.5088,786,The product reads or writes to a buffer using an index or pointer that references a memory location prior to the beginning of the buffer.,0.5084,146,0.1251,476,"A NULL pointer dereference occurs when the application dereferences a pointer that it expects to be valid, but is NULL, typically causing a crash or exit."
